/*

Today's Topic: Subqueries (in the Select, From, Group BY and Where Statement)

*/


Select *
From EmployeeSalary

--- Subquery in select

Select EmployeeID, Salary, (Select AVG(Salary) From EmployeeSalary) AS AllAvgSalary
From EmployeeSalary



--- How to do it with Partition By

Select EmployeeID, Salary, AVG(Salary) OVER () AS AllAvgSalary
From EmployeeSalary


--- Why Group By doesn't work

Select EmployeeID, Salary, AVG(Salary) AS AllAvgSalary
From EmployeeSalary
Group By EmployeeID, Salary
Order By 1,2

--- Subquery in From

Select a.EmployeeID, AllAvgSalary
From (Select EmployeeID, Salary, AVG(Salary) OVER () AS AllAvgSalary
      From EmployeeSalary) a




--- Subquery in Where

Select EmployeeID, JobTitle, Salary
From EmployeeSalary
Where EmployeeID in (
        Select EmployeeID
        From EmployeeDemographics
        Where Age > 30)
